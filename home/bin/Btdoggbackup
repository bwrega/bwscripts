#!/bin/fish

set dir /home/bartek/tym/btdogg_backup
set tmp "$dir/tmp"
set baseName (date "+%Y.%m.%d_%H:%M:%S")
set tmpDest "$tmp/$baseName"
set dest "$dir/dest"
if [ "$argv[1]" = "week" ]
	set dest "$dir/week"
end
set archive "$dest/$baseName.tar.gz"

mkdir -p "$tmpDest"
mkdir -p "$dest"


mongodump --gzip --db=btdogg -o "$tmpDest"

cd $tmp
tar czf "$archive" "$baseName"

rm -r "$tmpDest"

